# 项目3：受迫单摆的动力学行为与共振现象研究

## 1. 项目背景与简介

单摆是最经典的物理系统之一。在理想情况下，其小角度摆动是简谐运动。然而，当单摆受到外部周期性驱动力时，其动力学行为会变得更加复杂和有趣。本项目旨在研究一个受到特定形式水平周期性振荡力作用的单摆。

我们将通过数值方法求解其运动方程，观察摆角随时间的变化，并进一步探究系统在不同驱动频率下的响应，特别是寻找并分析共振现象，即当驱动力的频率与系统的某个“固有”特性相匹配时，摆动幅度达到最大的情况。

## 2. 核心运动方程

单摆受到一个小的水平振荡力时，其摆角 $\theta$ (弧度) 随时间 $t$ (秒) 变化的运动方程为：

$$
\frac{d^2\theta}{dt^2} = - \frac{g}{\ell}\sin\theta + C \cos\theta \sin(\Omega t)
$$

其中：
-   $g$ 是重力加速度 (通常取 $9.81 \, \mathrm{m/s^2}$)。
-   $\ell$ 是摆长 (单位：米)。
-   $C$ 是与驱动力强度相关的常数 (单位：$\mathrm{s}^{-2}$)。
-   $\Omega$ 是驱动力的角频率 (单位：$\mathrm{s}^{-1}$)。

为了进行数值求解，需要将上述二阶常微分方程转换为一个**一阶常微分方程组**。
令 $\omega = \frac{d\theta}{dt}$ (角速度)，则方程组为：

1.  $\frac{d\theta}{dt} = \omega$
2.  $\frac{d\omega}{dt} = - \frac{g}{\ell}\sin\theta + C \cos\theta \sin(\Omega t)$

状态向量可以表示为 $\mathbf{y} = [\theta, \omega]^T$。

## 3. 项目任务与步骤

### 任务 1: 特定参数下的数值解与可视化

1.  **实现方程求解函数：**
    编写一个Python函数，该函数接收当前时间 `t`、状态向量 `state` ($[\theta, \omega]$) 以及参数 ($\ell, g, C, \Omega$)，并返回状态向量的导数 ($[d\theta/dt, d\omega/dt]$)。
2.  **设置参数与初始条件：**
    *   摆长 $\ell = 10 \, \mathrm{cm} = 0.1 \, \mathrm{m}$。
    *   驱动力强度常数 $C = 2 \, \mathrm{s}^{-2}$。
    *   驱动力角频率 $\Omega = 5 \, \mathrm{s}^{-1}$。
    *   重力加速度 $g = 9.81 \, \mathrm{m/s^2}$。
    *   初始条件 (在 $t=0$ 时)：$\theta(0) = 0$ (初始摆角为0)，$\omega(0) = \frac{d\theta}{dt}(0) = 0$ (初始角速度为0)。
3.  **数值求解：**
    使用 `scipy.integrate.solve_ivp` 求解上述一阶常微分方程组。
    *   时间范围：从 $t=0$ 到 $t=100 \, \mathrm{s}$。
    *   选择足够多的时间点进行评估 (例如，`t_eval = np.linspace(0, 100, 2000)`) 以便后续绘图。
4.  **结果可视化：**
    绘制摆角 $\theta(t)$ 随时间 $t$ 变化的曲线图。观察摆动行为。

### 任务 2: 探究共振现象

1.  **目标：** 保持参数 $C = 2 \, \mathrm{s}^{-2}$ 和 $\ell = 0.1 \, \mathrm{m}$ 不变，通过改变驱动力角频率 $\Omega$，找到使单摆稳态摆动幅度（例如，在一段时间后 $\theta(t)$ 的最大绝对值）最大的 $\Omega$ 值。这个 $\Omega$ 值即为系统的（近似）共振频率。

2.  **方法：**
    *   选择一个合理的 $\Omega$ 值范围进行扫描。可以先估算小角度摆动下的自然频率 $\Omega_0 = \sqrt{g/\ell}$ 作为参考。例如，可以扫描 $\Omega$ 从 $\Omega_0/2$ 到 $2\Omega_0$ 的范围，或者更宽一些。
    *   对于选定范围内的每一个 $\Omega$ 值：
        *   使用与任务1相同的初始条件和求解方法，求解单摆的运动。建议模拟足够长的时间（例如 $t=0$ 到 $t=200 \, \mathrm{s}$ 或更长），以确保系统达到稳态响应或观察到足够多的摆动周期。
        *   确定在该 $\Omega$ 值下，摆角 $\theta(t)$ 在稳态阶段（例如，忽略初始的一段暂态时间，比如 $t > 50 \, \mathrm{s}$ 之后）的最大振幅 $A = \max(|\theta(t)|_{\text{steady state}})$。
    *   绘制最大振幅 $A$ 作为驱动力角频率 $\Omega$ 的函数的曲线图 (即 $A(\Omega)$ vs $\Omega$)。
    *   从图中找到使振幅 $A$ 最大的 $\Omega_{res}$ 值。

3.  **共振情况下的可视化：**
    使用找到的共振频率 $\Omega_{res}$，以及 $C = 2 \, \mathrm{s}^{-2}$, $\ell = 0.1 \, \mathrm{m}$ 和相同的初始条件，重新求解单摆的运动。
    绘制在此共振情况下，摆角 $\theta(t)$ 随时间 $t$ 变化的曲线图。

## 4. 提交内容建议

*   包含上述任务实现代码的forced_pendulum_student.py
*   包含上述任务的报告，包括：
*   **图表：**
    *   任务1：$\theta(t)$ vs $t$ 的曲线图 (对于 $\Omega = 5 \, \mathrm{s}^{-1}$)。
    *   任务2：最大稳态振幅 $A$ vs 驱动力角频率 $\Omega$ 的曲线图。
    *   任务2：在找到的共振频率 $\Omega_{res}$ 下，$\theta(t)$ vs $t$ 的曲线图。
*   **分析与讨论（简要）：**
    *   描述在 $\Omega = 5 \, \mathrm{s}^{-1}$ 时单摆的运动特征。
    *   报告找到的共振角频率 $\Omega_{res}$ 大约是多少。
    *   比较共振时的摆动与非共振时的摆动有何显著不同。
    *   （可选）将找到的共振频率与小角度近似下的自然频率 $\Omega_0 = \sqrt{g/\ell}$ 进行比较，并讨论可能的差异原因（如非线性项、驱动项的 $\cos\theta$ 因子等）。

**5. 提示与建议**

*   **单位：** 注意所有物理量的单位统一。摆长 $\ell$ 已从 cm 转换为 m。
*   **数值求解器：** `scipy.integrate.solve_ivp` 是推荐的工具。注意其 `args` 参数用于传递额外的固定参数给你的ODE函数。
*   **稳态振幅确定：** 在任务2中，为了确定稳态振幅，可能需要忽略求解初期的一段暂态过程。例如，只考虑 $t$ 大于某个值（如 $50s$ 或 $100s$）之后的数据来计算最大振幅。
*   **$\cos\theta$ 因子：** 注意驱动力项中包含 $\cos\theta$，这意味着驱动力的实际“效用”也与摆角有关，这可能使共振行为比简单的线性受迫振动更复杂。
*   **绘图：** 清晰的图表对于展示结果非常重要。确保坐标轴有标签和单位，图有标题。

