# cp2025-ODE-IVP
计算物理实验: 常微分方程初值问题

# 练习1:
Lotka--Volterra方程是生物种群之间的捕食者-猎物的数学模型. 用两个变量
$x$ 和 $y$ 代表两个物种的种群大小, 传统的模型中分别被叫做“兔子” (猎物) 和“狐狸” (捕食者).  可以把$x$和$y$当作以千为单位的种群数量, 比如$x=2$代表有2000只兔子. 严格来说, $x$ 和$y$ 的允许值是0.001的倍数, 因为兔子和狐狸的数目只能是整数. 但是0.001相对来说是一个较小的量, 所以可以合理的将$x$和$y$当作连续实数, 只要它们不非常接近于0.
在Lotka--Volterra模型中, 兔子繁殖率正比于它们的数量, 被捕食率正比于兔子和狐狸的数量:

$$

⁍
$$

这里$\alpha$ 和 $\beta$ 是常数. 同时狐狸的繁殖率正比于它们捕获兔子的数量---因为它们需要食物来生长和繁殖---但是死亡率正比于它们本身的数量:

$$

⁍
$$

其中 $\gamma$ 和 $\delta$ 也是常数.

1. 用4阶龙格-库塔法解这个方程组, 取 $\alpha=1$, $\beta=\gamma=0.5$, $\delta=2$, 初始条件 $x=y=2$. 在一幅坐标轴上画出$x$和$y$随时间的变化, 时间从$t=0$到$t=30$.  (提示: 注意这个微分方程组没有显式依赖于时间$t$, 在向量表示下, 方程右手边是函数$f(\vec{r})$, 不含$t$. 不过你可以定义Python函数\verb|f(r,t)|, 这样程序不用改变. 这虽然不是必须的, 但是可以避免困惑. 下面练习中的几个也缺少对时间的显式依赖.)
2. 以狐狸和兔子为例描述一下系统的行为.

# 练习2
洛伦兹方程是物理学中最著名的微分方程组之一：

$$
\begin{align*}{ d x\over d t} &= \sigma(y-x),\\{ d y\over d t} &= rx - y - xz,\\
{ d z\over d t}& = xy - bz,\end{align*}
$$

其中 $\sigma$, $r$, 和$b$ 是常数.  

这组方程是Edward Lorenz在1963年研究天气变化的简化模型时提出的.  这组方程著名的原因是它们是**确定性混沌**的第一个无可争议的例子, 尽管方程没有随机性, 但是却出现了随机运动. 另外一个混沌的例子是单峰映像(logistic map).

1. 写程序解洛伦兹方程组, 取$\sigma=10$, $r=28$, $b=\frac83$, $t$的范围从$t=0$ 到 $t=50$, 初始条件为$(x,y,z)=(0,1,0)$. 画出$y$和时间的关系图. 注意运动的不可预知性. (提示: 如果你用前面的程序, 要小心一点. 这个问题有参数$r$和$b$, 是和前面的程序中的变量同名的---确保给变量新的变量名或者用不能名字的参数, 以避免导致程序错误.) 
2. 修改程序画$z$ vs $x$图. 你会看到著名的“奇异吸引子”图像, 一幅蝶形图的侧面. 

# 练习3
如习题4中的单摆如果受到一个小的水平振荡力, 则运动方程变为

$$
		{ d^2\theta\over d t^2} = - {g\over\ell}\sin\theta
		+ C \cos\theta \sin\Omega t,
$$

其中 $C$ 和 $\Omega$ 是常数.

1. 写程序解出$\theta$, $\theta$是时间的函数, $\ell=10\,$cm, $C=2\,\mathrm{s}^{-2}$, $\Omega=5\,\mathrm{s}^{-1}$. 画 $\theta$ 随时间的变化图,  $t=0$ 到 $t=100\,$s.  初始值为$\theta=0$ 和  $d\theta/ d t=0$.
2. 保持$C$不变，改变$\Omega$, 找到与驱动力共振的单摆周期使得摆动幅度最大. 对这种情况画图.

# 练习4
很多物理问题中都存在简谐振荡, 力学，电磁学和致密物质物理学等. 考虑标准的简谐振荡方程

$$

⁍
$$

1. 用前面描述的方法将二阶常微分方程转化成一阶方程组. 写程序解这个方程组, 取$\omega=1$, 时间变化从$t=0$到$t=50$.  二阶微分方程需要两个初始条件, 一个是初值一个是导数初值. 在本题中的初条件是$x=1$ 和 $dx/ d t = 0$. 对$x$随时间的变化作图.
2. 增加振荡的幅度, 设初始值$x$更大, 比如$x=2$, 请说明振荡周期几乎不变.
3. 修改程序, 解由下列方程描述的非简谐振动

$$
{ d^2 x\over d t^2} = -\omega^2 x^3.
$$

仍然设$\omega=1$, 初始条件是 $x=1$, $d x/ d t=0$, 画图描述振子的运动.  改变振幅, 你会发现振幅大的时候振荡更快 (你也可以尝试更小的振幅, 振荡速度会变慢.)
4. 修改程序, 不要画$x$随$t$的变化, 画$d x/ d t$ 随$x$的变化, 即, 振荡速度和位移之间的关系. 这种图被称为相图.

# 练习5
van der Pol振子出现在电路和激光物理中, 由下面的方程描述

$$
{ d^2 x\over d t^2} - \mu (1-x^2) { d x\over d t} + \omega^2 x = 0.
$$

选择一种解常微分方程的方法, 在$t=0$到$t=20$解这个方程, 画van der Pol振子的相空间图, 取 $\omega=1$, $\mu=1$, 初始条件为 $x=1$ 和 $d x/ d t=0$.  尝试取$\mu=2$ 和 $\mu=4$ (保持$\omega=1$).  使时间间隔$h$足够小以确保获得一个平滑准确得相图.

许多基础力学问题研究物体在空气中运动或者飞行的轨迹, 但是为了使问题可解, 常常忽略空气阻力或者摩擦力. 如果是用计算机, 则不需要求方程组的解析解.

例如, 一个地面上的加农炮射出炮弹所受的空气阻力与运动方向相反, 量级为

$$
F = \frac{1}{2} \pi R^2\rho C v^2,
$$

其中$R$ 是炮弹半径, $\rho$是空气密度, $v$ 是速度, $C$ 被称为"拖曳"系数(与运动物体形状有关的参数, 本题中是球体).

1. 由牛顿第二定律出发, $F=ma$, 炮弹在二维空间$(x,y)$的运动方程是

$$
\ddot{x} = - {\pi R^2\rho C\over2m}\,			\dot{x}\sqrt{\dot{x}^2+\dot{y}^2},			\qquad			 \ddot{y} =  - g - {\pi R^2\rho C\over2m}\,			\dot{y}\sqrt{\dot{x}^2+\dot{y}^2},
$$

这里$m$是炮弹的质量, $g$ 是重力加速度, $\dot{x}$ 和 $\ddot{x}$是$x$
的关于时间的一阶和二阶导数.

2. 将两个二阶方程转化成4个1阶方程, 解质量为$1\,$kg, 半径为$8\,$cm 的炮弹的运动方程. 炮弹是以与地平线夹角$30^\circ$, 初始速度为$100\,\mathrm{m~s}^{-1}$发射的. 空气密度$\rho=1.22\,\textrm{kg}\,\textrm{m}^{-3}$ 球体的拖曳系数为 $C=0.47$.  画炮弹的轨迹 (即, $y$随$x$变化的图像).

3. 当忽略空气阻力的时候, 炮弹飞行的距离与质量无关. 但是实际上质量肯定会影响飞行距离. 用程序估计上面炮弹的飞行距离(水平方向), 检查炮弹的轻重会不会影响飞行距离. 你可以画一系列不同质量炮弹的轨迹, 或者画飞行距离和质量的关系图. 简单描述你的发现.

# 练习6
被路过的太空飞船抛弃的一个重铁棒和一个滚珠轴承在失重的情况下漂浮在太空中, 滚珠轴承在万有引力作用下绕着金属棒旋转:

![image.png](attachment:b6a2332b-0342-4ae0-998a-f8f87bae05f6:image.png)

为简化起见, 我们假设金属棒的粗细可以忽略, 重量足够大所以它自己的运动可以忽略不计, 滚珠轴承在垂直于棒体且位于棒体中间位置处的平面上绕金属棒运动.

1. 将金属棒当作重量为$M$长度为$L$的线段, 滚珠轴承看作是质量为$m$的质点, 则滚珠轴承受到的来自棒体的向心力由下式给出

$$
			\int_{-L/2}^{L/2} { d z\over(x^2+y^2+z^2)^{3/2}}\,,
$$

其中$G$是万有引力常数, $x$ 和 $y$ 是轴承在垂直于棒体的平面上的坐标.  闭合回路的积分可以给出

$$
F = {GMm\over\sqrt{(x^2+y^2)(x^2+y^2+L^2/4)}}
$$

因此在$xy$平面上点$x,y$的轴承的运动方程是

$$
			{ d^2 y\over d t^2} = - GM {y\over r^2\sqrt{r^2+L^2/4}},
$$

其中 $r=\sqrt{x^2+y^2}$.

1. 将这两个二阶方程转换成4个一阶方程. 选择单位使得$G=1$, 写程序解方程, 设 $M=10$, $L=2$, 初始位置为$(x,y)=(1,0)$, $y$方向的速度为$+1$. 计算时间从$t=0$到$20$的运动轨道并画图, 即$y$随$x$的变化图. 你会发现轴承并不是像行星那样按圆形或者椭圆形的轨道运动的, 而是一个进动轨道, 进动产生的原因是轴承所受的是吸引力不是与$1/r^2$成反比的力, 这与行星绕太阳运动不同.
